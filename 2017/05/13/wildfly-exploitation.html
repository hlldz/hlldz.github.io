<!DOCTYPE html>
<html lang="en"><head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@400;600&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;600&display=swap" rel="stylesheet"><!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Wildfly Exploitation | with knowledge comes power</title>
<meta name="generator" content="Jekyll v4.2.0" />
<meta property="og:title" content="Wildfly Exploitation" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Once upon a time, I was working on a penetration test. All day, I looked for an entry point but there was no any exploitable vulnerability on customer systems. I couldn’t get any system neither low privileges nor high privileges. During the penetration test, I found a default/predictable credentials on WildFly Application Server. I hadn’t heart that application before. I searched on internet it and there wasn’t anything on internet about the Wildfly exploitation. So I decided analyze the application. How can I get system over the Wildfly application?" />
<meta property="og:description" content="Once upon a time, I was working on a penetration test. All day, I looked for an entry point but there was no any exploitable vulnerability on customer systems. I couldn’t get any system neither low privileges nor high privileges. During the penetration test, I found a default/predictable credentials on WildFly Application Server. I hadn’t heart that application before. I searched on internet it and there wasn’t anything on internet about the Wildfly exploitation. So I decided analyze the application. How can I get system over the Wildfly application?" />
<link rel="canonical" href="/2017/05/13/wildfly-exploitation.html" />
<meta property="og:url" content="/2017/05/13/wildfly-exploitation.html" />
<meta property="og:site_name" content="with knowledge comes power" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2017-05-13T16:37:00+03:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Wildfly Exploitation" />
<script type="application/ld+json">
{"mainEntityOfPage":{"@type":"WebPage","@id":"/2017/05/13/wildfly-exploitation.html"},"description":"Once upon a time, I was working on a penetration test. All day, I looked for an entry point but there was no any exploitable vulnerability on customer systems. I couldn’t get any system neither low privileges nor high privileges. During the penetration test, I found a default/predictable credentials on WildFly Application Server. I hadn’t heart that application before. I searched on internet it and there wasn’t anything on internet about the Wildfly exploitation. So I decided analyze the application. How can I get system over the Wildfly application?","@type":"BlogPosting","url":"/2017/05/13/wildfly-exploitation.html","headline":"Wildfly Exploitation","dateModified":"2017-05-13T16:37:00+03:00","datePublished":"2017-05-13T16:37:00+03:00","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="/feed.xml" title="with knowledge comes power" /><script async src="https://www.googletagmanager.com/gtag/js?id=UA-88697757-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-88697757-1');
</script>

</head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">with knowledge comes power</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Wildfly Exploitation</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2017-05-13T16:37:00+03:00" itemprop="datePublished">May 13, 2017
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>Once upon a time, I was working on a penetration test. All day, I looked for an entry point but there was no any exploitable vulnerability on customer systems. I couldn’t get any system neither low privileges nor high privileges. During the penetration test, I found a default/predictable credentials on WildFly Application Server. I hadn’t heart that application before. I searched on internet it and there wasn’t anything on internet about the Wildfly exploitation. So I decided analyze the application. How can I get system over the Wildfly application?</p>

<p><img src="/assets/images/2017-05-13-wildfly-exploitation/wildfly.png" alt="Wildfly" class="center-image" /></p>

<p>After a couple of time I figured out;</p>

<blockquote>
  <p>WildFly, formerly known as JBoss AS, or simply JBoss, is an application server authored by JBoss, now developed by Red Hat. WildFly is written in Java, and implements the Java Platform, Enterprise Edition (Java EE) specification. It runs on multiple platforms. WildFly is free and open-source software, subject to the requirements of the GNU Lesser General Public License (LGPL), version 2.1.<sup>1</sup></p>
</blockquote>

<p>As written above description, Wildfly is an application server based on Java. If you get a Java-based application, should not it be so hard to get the system? As you know three billion devices run Java. :P</p>

<p><img src="/assets/images/2017-05-13-wildfly-exploitation/java.png" alt="Java" /></p>

<h2 id="exploitation">Exploitation</h2>

<p>After accessing that credentials, I saw my customer using an application on Wildfly which has a .WAR extension. I can exploit that system like exploiting Tomcat!? No, unfortunately Wildfly did not worked the .WAR file which I created for Tomcat or Glassfish before. I read Wildfly documentation and I found how to create averagely a .WAR file for Wildfly. So, I create my own customized .WAR shell.</p>

<p>Wildfly wants a directory which is called WEB-INF and I created custom a <code class="language-plaintext highlighter-rouge">jboss-web.xml</code> file under the WEB-INF directory. The <code class="language-plaintext highlighter-rouge">jboss-web.xml</code> must contain simply following lines;</p>

<figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
    <span class="nt">&lt;jboss-web</span> <span class="na">xmlns=</span><span class="s">"http://www.jboss.com/xml/ns/javaee"</span> <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span> <span class="na">xsi:schemaLocation=</span><span class="s">" http://www.jboss.com/xml/ns/javaee http://www.jboss.org/j2ee/schema/jboss-web_5_1.xsd"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;context-root&gt;</span>/wildPwn<span class="nt">&lt;/context-root&gt;</span>
    <span class="nt">&lt;/jboss-web&gt;</span></code></pre></figure>

<p>The <code class="language-plaintext highlighter-rouge">&lt;context-root&gt;</code> tag means, your application directory. If you write <code class="language-plaintext highlighter-rouge">wildPwn</code> it will be accessible under that directory. By the way, I used modified Laudanum’s cmd.jsp as shell for bypassing endpoint security solution. Finally I uploaded my .WAR file and I was accessed the shell using that URL schema; <a href="http://ipOrDomain.com:port/shellDirectory/shell.jsp">http://ipOrDomain.com:port/shellDirectory/shell.jsp</a></p>

<p>After penetration test, I wrote a tool for Wildfly called wildPwn. It can accessable on Github, <a href="https://github.com/hlldz/wildPwn">wildPwn Project</a>.</p>

<p>wildPwn can brute force the Wildfly and upload a shell for running system commands on target. You can access usage video on YouTube, <a href="https://www.youtube.com/watch?v=kTsPwA7QhLU">wildPwn usage video</a>.</p>

<p><img src="/assets/images/2017-05-13-wildfly-exploitation/wildpwn.png" alt="wildPwn" />
<em>wildPwn</em></p>

<h2 id="nmap-scripts">Nmap Scripts</h2>

<p>Also Nmap scripts are ready for detection and brute force processes. You can access that scripts under Nmap Scripts directroy of <a href="https://github.com/hlldz/wildPwn/tree/master/Nmap%20Scripts">wildPwn project</a>.</p>

<p>For detection,</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">nmap <span class="nt">--script</span> wildfly-detect &lt;TARGET&gt;</code></pre></figure>

<p>Sample output,</p>

<p><img src="https://raw.githubusercontent.com/hlldz/wildPwn/master/Nmap%20Scripts/wildfly-detect.png" alt="Wildfly Detection" />
<em>Wildfly Detection</em></p>

<p>For brute force,</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">nmap <span class="nt">-p</span> 9990 <span class="nt">--script</span> wildfly-brute <span class="nt">--script-args</span> <span class="s2">"userdb=usernameList.txt,passdb=passList.txt,hostname=domain.com"</span> &lt;TARGET&gt;</code></pre></figure>

<p>Sample output,</p>

<p><img src="https://raw.githubusercontent.com/hlldz/wildPwn/master/Nmap%20Scripts/wildfly-brute.png" alt="Wildfly Brute Force" />
<em>Wildfly Brute Force</em></p>

<p>Happy Hunting!</p>

<h2 id="referanslar">Referanslar</h2>
<ol>
  <li><a href="https://en.wikipedia.org/wiki/WildFly">Wildfly - Wikipedia</a></li>
  <li><a href="https://docs.jboss.org/author/display/WFLY10/Documentation">Wildfly Documentation</a></li>
</ol>

  </div><a class="u-url" href="/2017/05/13/wildfly-exploitation.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">with knowledge comes power</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">with knowledge comes power</li><li><a class="u-email" href="mailto:artofpwn.com">artofpwn.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/hlldz"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">hlldz</span></a></li><li><a href="https://www.linkedin.com/in/hlldz"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#linkedin"></use></svg> <span class="username">hlldz</span></a></li><li><a href="https://www.twitter.com/hlldz"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">hlldz</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Hi, this is Halil Dalabasmaz&#39;s personal blog. Feel free to leave feedback!</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
